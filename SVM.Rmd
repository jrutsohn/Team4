---
title: "SVM"
author: "Tianyou Luo"
date: "April 21, 2020"
output: html_document
---


```{r}
library(tidyverse)
library(caret)

dat = read_csv("imputedData.csv")
dat = dat %>%
  mutate(ID = row_number()) %>%
  select(ID, everything())

# To show codes on a smaller dataset:
set.seed(735)
dat_sel = sample_n(dat, 10000)

## duration was mentioned in the readme file that it should not be used
## default only has three people answering "yes", so I am not using it
dat_svm = dat_sel %>% select(-ID, -duration, -default)
dat_svm$y = as.factor(ifelse(dat_svm$y == "yes", 1, 0))

dat_svm_x = model.matrix(y~., data = dat_svm)
trCtl <- trainControl(method="cv", number=5, savePredictions=TRUE)


# svm with radial kernel
start = Sys.time()
svmRad = train(dat_svm_x, dat_svm$y, method = "svmRadial", 
               tuneLength = 5, trControl = trCtl)
end = Sys.time()
time_svmRad = end - start
print(time_svmRad)

dat_svm$predict = svmRad$finalModel@fitted
confusionMatrix(dat_svm$predict, dat_svm$y)
```

